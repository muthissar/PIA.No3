#!/bin/bash
DEBUG="FALSE"
PORT="5678"
while (( "$#" )); do
  case "$1" in
    --debug)
      DEBUG="TRUE"
      shift
      ;;
    --port)
      PORT="$2"
      shift 2
      ;;
    --)
      shift
      break
      ;;
    *)
      echo "Error: Invalid argument"
      exit 1
  esac
done
if [ "$DEBUG" = "TRUE" ]; then
    CMD="python -m debugpy --listen 127.0.0.1:${PORT} --wait-for-client"
else
    CMD="python"
fi
python combine_configs.py | xargs -I {} bash -c "${CMD} ic_gen.py --config {} eval"